<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="application-name" content="DartStream Scoring App">
    <meta name="apple-mobile-web-app-title" content="DartStream Scoring App">
    <link rel="icon" type="image/png" href="dartstream-logo.png">
    <link rel="apple-touch-icon" href="dartstream-logo.png">
    <link rel="manifest" href="manifest-scoring.json">
    <title>DartStream - Professional Dart Live Streaming Tools</title>
    <script src="browser-detect.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    
    <div id="app">
        <!-- Game Mode Selection Screen - Hidden -->
        <div id="game-mode-screen" class="screen" style="display: none;">
            <div class="modal-header">
                <h1>Choose Game Mode</h1>
            </div>
            <div class="modal-content">
                <div class="game-options">
                    <button class="game-option-btn" data-game="quick-501">
                        <strong>Quick 501</strong> <em>SIDO</em><br>
                        <span>Alternate start, Best of 3 legs</span>
                    </button>
                    <button class="game-option-btn" data-game="extended-501">
                        <strong>Extended 501</strong> <em>SIDO</em><br>
                        <span>Alternate start, Best of 9 legs</span>
                    </button>
                    <button class="game-option-btn" data-game="quick-301">
                        <strong>Quick 301</strong> <em>DIDO</em><br>
                        <span>Alternate start, Best of 3 legs</span>
                    </button>
                    <button class="game-option-btn" data-game="extended-301">
                        <strong>Extended 301</strong> <em>DIDO</em><br>
                        <span>Alternate start, Best of 5 legs</span>
                    </button>
                    <button class="game-option-btn custom" data-game="custom">
                        <strong>Custom Match Menu</strong><br>
                        <span>Create your own match rules</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Game Type Quick Selection Screen -->
        <div id="game-type-select-screen" class="screen">
            <div class="modal-header">
                <h1>Select Game Type</h1>
            </div>
            <div class="modal-content">
                <div class="game-options">
                    <button class="game-option-btn" id="select-301-game">
                        <strong>301 DIDO</strong>
                    </button>
                    <button class="game-option-btn" id="select-501-game">
                        <strong>501 SIDO</strong>
                    </button>
                    <button class="game-option-btn custom" id="select-custom-game">
                        <strong>Custom X01</strong>
                    </button>
                </div>
                <button class="back-btn" id="back-from-game-type">Back to Starting Player</button>
            </div>
        </div>

        <!-- Match Settings Screen -->
        <div id="match-settings-screen" class="screen">
            <div class="modal-header">
                <h1>Match Settings</h1>
            </div>
            <div class="modal-content match-settings-content">
                <button class="advanced-settings-btn" id="advanced-settings-btn">Advanced Settings</button>
                
                <div class="settings-section" id="simple-settings">
                    <div class="settings-header-grid">
                        <h2 class="section-title left">Best of</h2>
                        <h2 class="section-title right">First to</h2>
                    </div>
                    <div class="settings-grid">
                        <button class="settings-btn" data-legs="1">1 Leg</button>
                        <button class="settings-btn first-to" data-legs="1">1 Wins</button>
                    </div>
                    <div class="settings-grid">
                        <button class="settings-btn selected" data-legs="3">3 Legs</button>
                        <button class="settings-btn first-to selected" data-legs="2">2 Wins</button>
                    </div>
                    <div class="settings-grid">
                        <button class="settings-btn" data-legs="5">5 Legs</button>
                        <button class="settings-btn first-to" data-legs="3">3 Wins</button>
                    </div>
                    <div class="settings-grid">
                        <button class="settings-btn" data-legs="7">7 Legs</button>
                        <button class="settings-btn first-to" data-legs="4">4 Wins</button>
                    </div>
                    <div class="settings-grid">
                        <button class="settings-btn" data-legs="9">9 Legs</button>
                        <button class="settings-btn first-to" data-legs="5">5 Wins</button>
                    </div>
                    <div class="settings-grid">
                        <button class="settings-btn" data-legs="11">11 Legs</button>
                        <button class="settings-btn first-to" data-legs="6">6 Wins</button>
                    </div>
                    <button class="custom-leg-btn" id="custom-leg-count-btn">Custom Leg Count</button>
                    
                    <h2 class="section-title section-spacing-top">Play All</h2>
                    <div class="play-all-grid">
                        <button class="settings-btn play-all" data-legs="1">1 Leg</button>
                        <button class="settings-btn play-all" data-legs="2">2 Legs</button>
                        <button class="settings-btn play-all" data-legs="3">3 Legs</button>
                        <button class="settings-btn play-all" data-legs="4">4 Legs</button>
                        <button class="settings-btn play-all" data-legs="5">5 Legs</button>
                        <button class="settings-btn play-all" data-legs="6">6 Legs</button>
                    </div>
                    
                    <button class="continue-btn" id="simple-continue-btn">Continue</button>
                </div>

                <div class="settings-section" id="advanced-settings" style="display: none;">
                    <h2 class="section-title">1. How Many Sets?</h2>
                    <div class="sets-input-container">
                        <input type="number" id="sets-count-input" class="sets-input" min="1" max="99" value="1" placeholder="# of Sets">
                        <div class="settings-row">
                            <button class="settings-option-btn selected" id="sets-best-of">Best Of</button>
                            <button class="settings-option-btn" id="sets-play-all">Play All</button>
                        </div>
                    </div>

                    <h2 class="section-title">2. How Many Legs Per Set?</h2>
                    <div class="legs-input-container">
                        <input type="number" id="legs-count-input" class="legs-input" min="1" max="99" value="5" placeholder="# of Legs">
                        <div class="settings-row">
                            <button class="settings-option-btn selected" id="legs-best-of">Best Of</button>
                            <button class="settings-option-btn" id="legs-play-all">Play All</button>
                        </div>
                    </div>

                    <h2 class="section-title">3. Select Game Type</h2>
                    <div class="settings-row">
                        <button class="settings-option-btn" id="game-type-every-leg">Every Leg</button>
                        <button class="settings-option-btn" id="game-type-per-set">Once Per Set</button>
                        <button class="settings-option-btn selected" id="game-type-per-match">Once Per Match</button>
                    </div>

                    <h2 class="section-title">4. Select Player Start Format</h2>
                    <div class="settings-row">
                        <button class="settings-option-btn selected" id="start-alternate">Alternate</button>
                        <button class="settings-option-btn" id="start-bull-up">Bull Up</button>
                    </div>
                    <div class="settings-row" id="alternate-options">
                        <button class="settings-option-btn" id="start-random">Random Match Start</button>
                        <button class="settings-option-btn selected" id="start-bull-first">Bull First Match Leg</button>
                        <button class="settings-option-btn" id="start-bull-last">Bull Last Match Leg</button>
                    </div>
                    <div class="settings-row" id="bull-up-options" style="display: none;">
                        <button class="settings-option-btn" id="bull-select-player">Select Player</button>
                        <button class="settings-option-btn" id="bull-show-all">Show All Starting Options</button>
                    </div>

                    <button class="continue-btn" id="advanced-continue-btn">Continue</button>
                    <button class="reset-btn" id="reset-settings-btn">Reset</button>
                </div>
            </div>
        </div>

        <!-- Custom Game Selection Screen -->
        <div id="custom-game-screen" class="screen">
            <div class="modal-header">
                <h1>Custom X01 Game</h1>
            </div>
            <div class="modal-content">
                <h2 class="yellow-text">Select Starting Score</h2>
                <div class="custom-game-options">
                    <button class="game-option-btn" data-custom="101">101</button>
                    <button class="game-option-btn" data-custom="201">201</button>
                    <button class="game-option-btn" data-custom="301">301</button>
                    <button class="game-option-btn" data-custom="401">401</button>
                    <button class="game-option-btn" data-custom="501">501</button>
                    <button class="game-option-btn" data-custom="601">601</button>
                    <button class="game-option-btn" data-custom="701">701</button>
                    <button class="game-option-btn" data-custom="801">801</button>
                    <button class="game-option-btn" data-custom="901">901</button>
                    <button class="game-option-btn" data-custom="1001">1001</button>
                </div>
                
                <h2 class="yellow-text section-spacing-top">Start Type</h2>
                <div class="custom-options-row">
                    <button class="option-btn selected" id="start-type-si">Straight In</button>
                    <button class="option-btn" id="start-type-di">Double In</button>
                </div>
                
                <h2 class="yellow-text section-spacing">Finish Type</h2>
                <div class="custom-options-row">
                    <button class="option-btn" id="finish-type-so">Straight Out</button>
                    <button class="option-btn selected" id="finish-type-do">Double Out</button>
                </div>
                
                <button class="back-btn" id="back-from-custom">Back to Game Modes</button>
            </div>
        </div>

        <!-- Match Settings Modal -->
        <div id="match-settings-modal" class="modal">
            <div class="modal-dialog">
                <div class="modal-header">
                    <button class="header-btn">‚Ñπ</button>
                    <h2>Match Settings</h2>
                </div>
                <div class="modal-content">
                    <button class="settings-btn gold">Advanced Settings</button>
                    
                    <h3>Best of <span style="float:right">First to</span></h3>
                    <button class="setting-option">1 Leg <span class="right-label">1 Wins</span></button>
                    <button class="setting-option selected">3 Legs <span class="right-label">2 Wins</span></button>
                    <button class="setting-option">5 Legs <span class="right-label">3 Wins</span></button>
                    <button class="setting-option">7 Legs <span class="right-label">4 Wins</span></button>
                    <button class="setting-option">9 Legs <span class="right-label">5 Wins</span></button>
                    <button class="setting-option">11 Legs <span class="right-label">6 Wins</span></button>
                    <button class="settings-btn gold">Custom Leg Count</button>
                    
                    <button class="continue-btn green">Continue</button>
                </div>
            </div>
        </div>

        <!-- Advanced Match Settings Modal -->
        <div id="advanced-settings-modal" class="modal">
            <div class="modal-dialog">
                <div class="modal-header">
                    <button class="header-btn">‚Ñπ</button>
                    <h2>Match Settings</h2>
                </div>
                <div class="modal-content">
                    <h3>1. Select Set Format (optional)</h3>
                    <div class="setting-row">
                        <button class="setting-option">"Best Of"</button>
                        <button class="setting-option">#</button>
                        <button class="setting-option">Play All Sets</button>
                    </div>

                    <h3>2. Select Legs Format</h3>
                    <div class="setting-row">
                        <button class="setting-option selected">"Best Of"</button>
                        <button class="setting-option">Play Every Leg</button>
                    </div>
                    <div class="setting-row">
                        <button class="setting-option">Select Number of<br>Legs Before Each Set</button>
                        <button class="setting-option selected">Same Number of<br>Legs For All Sets</button>
                    </div>

                    <h3>3. Select Game Type</h3>
                    <div class="setting-row">
                        <button class="setting-option">Every<br>Leg</button>
                        <button class="setting-option">Once<br>Per Set</button>
                        <button class="setting-option selected">Once<br>Per Match</button>
                    </div>

                    <h3>4. Select Player Start Format</h3>
                    <button class="setting-option wide selected">Alternate</button>
                    <div class="setting-row">
                        <button class="setting-option">Random<br>Match Start</button>
                        <button class="setting-option selected">Bull First<br>Match Leg</button>
                        <button class="setting-option">Bull Last<br>Match Leg</button>
                    </div>

                    <button class="continue-btn green">Continue</button>
                    <button class="continue-btn red">Reset</button>
                </div>
            </div>
        </div>

        <!-- Game Selection (DartStream) Screen -->
        <div id="game-selection-screen" class="screen">
            <div class="game-header">
                <h2 class="set-score">Set <span class="score-display">0 - 0</span> | Leg <span class="score-display">0 - 0</span></h2>
            </div>

            <div class="dartconnect-logo">
                <h1>DartStream</h1>
                <p class="yellow-text">Professional Dart Live Streaming Tools</p>
            </div>

            <div class="game-type-selection">
                <button class="game-type-btn" data-type="301">301 DIDO</button>
                <button class="game-type-btn" data-type="501">501 SIDO</button>
                <button class="game-type-btn custom" id="custom-game-link">Custom Game</button>
            </div>

            <div class="bottom-bar">
                <button class="bottom-btn green" id="select-players-btn2">Select Players</button>
            </div>

            <div class="match-info-bar">
                <div class="match-avg">0 / 0.0<br>Match</div>
                <div class="set-display">S1</div>
                <div class="set-score-big">0 - 0</div>
                <div class="legs-format">(3)</div>
                <div class="match-avg">0 / 0.0<br>Match</div>
            </div>
        </div>

        <!-- Starting Player Selection Screen -->
        <div id="starting-player-screen" class="screen active">
            <div class="scoreboard-header">
                <div class="player-header left">
                    <div class="player-name-large" id="starting-player1-name-top">Matthew Dow</div>
                    <div class="score-large" id="starting-player1-score-top">501</div>
                    <div class="dart-logo">DART<br>CONNECT</div>
                </div>
                <div class="timer-display">
                    <img src="dartstream-logo.png" alt="DartStream" class="game-logo">
                    <div class="version-text">v1.0.0</div>
                </div>
                <div class="player-header right">
                    <div class="player-name-large" id="starting-player2-name-top">Moe C</div>
                    <div class="score-large" id="starting-player2-score-top">501</div>
                </div>
            </div>

            <div class="starting-selection">
                <h2 class="yellow-text">Select Starting Player</h2>
                <button class="starting-player-btn" id="start-player1">Matthew Dow</button>
                <button class="starting-player-btn" id="start-player2">Moe Cormier</button>
                <div class="coin-options">
                    <button class="coin-btn" id="coin-toss-btn">Coin Toss</button>
                    <button class="coin-btn green" id="random-btn">Random</button>
                    <button class="coin-btn" id="skip-btn">Skip</button>
                </div>
                <div class="game-info">
                    <button class="game-format-display" id="game-format-btn">501 SIDO</button>
                    <button class="legs-format-display" id="legs-format-btn">Best of 3 Legs</button>
                </div>
            </div>

            <!-- Coin Toss Result -->
            <div id="coin-result-display" class="coin-result-display" style="display: none;">
                <div class="coin-result-content">
                    <h2 id="coin-result-text"></h2>
                </div>
            </div>

            <div class="bottom-bar">
                <h2 class="set-score-bottom">Set <span class="score-display">0 - 0</span> | Leg <span class="score-display">0 - 0</span></h2>
            </div>
        </div>

        <!-- Main Game Screen -->
        <div id="game-screen" class="screen">
            <div class="scoreboard-header">
                <div class="player-header left" id="player1-display">
                    <div class="player-info">
                        <div class="player-name-large">Home</div>
                        <div class="score-large">501</div>
                        <div class="averages-display">
                            <div class="avg-label red" id="player1-leg-avg">0.00</div>
                            <div class="avg-label red" id="player1-match-avg">0.00</div>
                        </div>
                    </div>
                </div>
                <div class="timer-display">
                    <img src="dartstream-logo.png" alt="DartStream" class="game-logo">
                    <div class="version-text">v1.0.0</div>
                </div>
                <div class="player-header right active" id="player2-display">
                    <div class="player-info">
                        <div class="player-name-large">Away</div>
                        <div class="score-large">501</div>
                        <div class="averages-display">
                            <div class="avg-label red" id="player2-leg-avg">0.00</div>
                            <div class="avg-label red" id="player2-match-avg">0.00</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="control-bar">
                <h2 class="set-score-inline" style="width: 100%; text-align: center;">Set <span class="score-display" id="set-score-display">0 - 0</span> | Leg <span class="score-display" id="leg-score-display">0 - 0</span></h2>
            </div>

            <div class="scoring-area">
                <div class="score-history" id="score-history">
                    <!-- Score entries will be added here dynamically -->
                </div>
                
                <!-- Good Shot Display -->
                <div id="good-shot-display" class="good-shot-display" style="display: none;">
                    <div class="good-shot-text" id="good-shot-text"></div>
                </div>
            </div>

            <div class="bottom-controls">
                <div class="input-bar">
                    <button class="input-btn yellow" id="action-btn">UNDO</button>
                    <div class="input-mode" id="input-mode"></div>
                    <button class="input-btn red" id="submit-btn">MISS</button>
                </div>

                <div class="number-pad">
                    <button class="num-btn edge" data-score="26">26</button>
                    <button class="num-btn" data-score="1">1</button>
                    <button class="num-btn" data-score="2">2</button>
                    <button class="num-btn" data-score="3">3</button>
                    <button class="num-btn edge" data-score="45">45</button>
                    
                    <button class="num-btn edge" data-score="40">40</button>
                    <button class="num-btn" data-score="4">4</button>
                    <button class="num-btn" data-score="5">5</button>
                    <button class="num-btn" data-score="6">6</button>
                    <button class="num-btn edge" data-score="60">60</button>
                    
                    <button class="num-btn edge" data-score="41">41</button>
                    <button class="num-btn" data-score="7">7</button>
                    <button class="num-btn" data-score="8">8</button>
                    <button class="num-btn" data-score="9">9</button>
                    <button class="num-btn edge" data-score="81">81</button>
                    
                    <button class="num-btn edge" data-score="43">43</button>
                    <button class="num-btn special green dual-function" id="btn-100-multiply" data-score="100" data-operation="multiply" data-default="100" data-alt="√ó">100</button>
                    <button class="num-btn special red dual-function" id="btn-180-zero" data-score="180" data-operation="zero" data-default="180" data-alt="0">180</button>
                    <button class="num-btn special green dual-function" id="btn-140-plus" data-score="140" data-operation="plus" data-default="140" data-alt="+">140</button>
                    <button class="num-btn edge" data-score="85">85</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Finish Darts Modal -->
    <div id="finish-darts-modal" class="modal-overlay">
        <div class="modal-content">
            <h2 class="modal-title">How many darts to finish?</h2>
            <div class="finish-darts-buttons">
                <button class="finish-dart-btn" data-darts="1">
                    <img src="button 1.png" alt="1 Dart">
                </button>
                <button class="finish-dart-btn" data-darts="2">
                    <img src="button 2.png" alt="2 Darts">
                </button>
                <button class="finish-dart-btn" data-darts="3">
                    <img src="button 3.png" alt="3 Darts">
                </button>
            </div>
        </div>
    </div>

    <!-- Game Shot Winner Modal -->
    <div id="game-shot-modal" class="modal-overlay">
        <div class="modal-content winner-modal">
            <h2 class="modal-header-dark">Game Shot Winner:</h2>
            <h1 class="winner-name" id="winner-name">Home</h1>
            <h2 class="match-score" id="match-score">0 - 1</h2>
            <a href="#" class="hide-confirmation">Hide this confirmation</a>
            <button class="confirm-btn green" id="confirm-win-btn">Confirm</button>
            <button class="confirm-btn red" id="change-win-btn">Change</button>
            <button class="refresh-btn">Refresh App</button>
        </div>
    </div>

    <!-- Match Complete Modal -->
    <div id="match-complete-modal" class="modal-overlay">
        <div class="modal-content set-complete-modal">
            <div class="set-complete-header">
                <div class="player-score-display" id="match-winner-display">
                    <div class="player-label" id="match-winner-name">Winner</div>
                    <div class="score-value" style="font-size: 72px;">üèÜ</div>
                </div>
            </div>
            <h3 class="next-set-text" id="match-complete-text">Match Complete!</h3>
            <div class="match-stats-summary" id="match-stats-summary" style="margin: 20px 0; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 8px;">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 16px;">
                    <div id="player1-final-stats"></div>
                    <div id="player2-final-stats"></div>
                </div>
            </div>
            <div class="set-complete-buttons">
                <button class="set-btn yellow" id="discard-match-btn">Return to Main Menu</button>
            </div>
        </div>
    </div>

    <!-- Forfeit Modal -->
    <div id="forfeit-modal" class="modal-overlay">
        <div class="modal-content set-complete-modal">
            <div class="set-complete-header">
                <div class="set-title">
                    <div class="set-number">Exit Match</div>
                    <div class="set-status" id="forfeit-status-text">Choose Outcome</div>
                </div>
            </div>
            <h3 class="next-set-text" id="forfeit-instruction-text">Select who forfeits or declare a draw</h3>
            <div class="match-stats-summary" id="forfeit-score-display" style="margin: 20px 0; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 8px;">
                <div style="text-align: center; font-size: 24px; font-weight: bold;">
                    Current Score: <span id="forfeit-current-score">0-0</span>
                </div>
            </div>
            <div class="set-complete-buttons" id="forfeit-options">
                <button class="set-btn red" id="player1-forfeit-btn">Player 1 Forfeits</button>
                <button class="set-btn red" id="player2-forfeit-btn">Player 2 Forfeits</button>
            </div>
            <div class="set-complete-buttons" id="draw-option" style="display: none;">
                <button class="set-btn yellow" id="declare-draw-btn">Declare Draw</button>
            </div>
            <div class="set-complete-buttons">
                <button class="set-btn gray" id="cancel-forfeit-btn">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Set Complete Modal -->
    <div id="set-complete-modal" class="modal-overlay">
        <div class="modal-content set-complete-modal">
            <div class="set-complete-header">
                <div class="player-score-display" id="set-home-score">
                    <div class="player-label">Home</div>
                    <div class="score-value">0</div>
                </div>
                <div class="set-title">
                    <div class="set-number" id="set-complete-number">Set 01</div>
                    <div class="set-status">Complete</div>
                </div>
                <div class="player-score-display" id="set-away-score">
                    <div class="player-label">Away</div>
                    <div class="score-value">1</div>
                </div>
            </div>
            <h3 class="next-set-text" id="next-set-text">Next Set: Play 501 SIDO Again</h3>
            <div class="set-complete-buttons">
                <button class="set-btn green" id="next-set-btn">Next Set</button>
                <button class="set-btn yellow" id="change-game-btn">Change Game</button>
            </div>
            <div class="set-complete-buttons">
                <button class="set-btn yellow" id="edit-match-settings-btn">Back to Starting Player</button>
                <button class="set-btn red" id="end-match-btn">End Match</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
